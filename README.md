# hpcviewer.e4

hpcviewer is the presentation layer of HPCToolkit which is a suite of tools
for measurement and analysis of program performance.
It interactively presents program performance in a top-down fashion and also 
visualizes trace data generated by hpcrun if the flag ```-t``` is specified. 
For static linked program, the variable environment ```HPCRUN_TRACE``` has to be set. 

## General Requirements

* Java 11. 
  Can be downloaded via Spack 
  or from Oracle https://www.oracle.com/java/technologies/javase-downloads.html 
  or AdoptJDK https://adoptopenjdk.net
* Linux: GTK+ 3.20 or newer.
To check installed GTK version on Red Hat distributions:
```
rpm -q gtk3
```
On Debian-based distributions:
```
dpkg -l  libgtk-3-0
apt-cache policy libgtk-3-0
```
If there is no GTK+ 3.20 or newer installed in the system, you may install it via `spack`:
```
spack install gtkplus
spack load gtkplus
```

## How to build and run via command line (Maven)

* Download and install Maven (if not available on the systems) at https://maven.apache.org/
  * Recommended: install via spack
  	`spack install maven; spack load maven`  
  	
* On Posix-based platform with Bash shell (Linux and MacOS), type:
    ```
    ./build.sh
    ``` 
    This will build Linux x86_64, Linux ppc64le and Windows with Eclipse 4.16,
    and Linux Arm (experimental) and MacOS with Eclipse 4.18.
    The script generates five `hpcviewer-<release>-<platform>.[zip|tgz]` files:
    Windows, Mac, Linux, x86_64, Linux ppcle64, and Linux Arm (experimental).
  * `untar` or `unzip` the file based according to the platform. 
  * For Linux platform: run 
  ```./install.sh <directory>``` 
  to install the viewer. 
  
* On Windows type:
   ```
   mvn clean package
   ```
  This will compile and create hpcviewer packages for 4 platforms: Linux x86_64 and ppcle64, Windows and Mac
  with Eclipse 4.16 (the default).
  Example of the output:
```
...
[INFO] --- tycho-p2-director-plugin:1.6.0:archive-products (archive-prodcuts) @ edu.rice.cs.hpcviewer ---
[INFO] Building tar: <hpcviewer.e4>/edu.rice.cs.hpcviewer.product/target/products/edu.rice.cs.hpcviewer-linux.gtk.x86_64.tar.gz
[INFO] Building tar: <hpcviewer.e4>/edu.rice.cs.hpcviewer.product/target/products/edu.rice.cs.hpcviewer-linux.gtk.ppc64le.tar.gz
[INFO] Building zip: <hpcviewer.e4>/edu.rice.cs.hpcviewer.product/target/products/edu.rice.cs.hpcviewer-win32.win32.x86_64.zip
[INFO] Building zip: <hpcviewer.e4>/edu.rice.cs.hpcviewer.product/target/products/edu.rice.cs.hpcviewer-macosx.cocoa.x86_64.zip
[INFO] ------------------------------------------------------------------------
```
  * Unzip `edu.rice.cs.hpcviewer-win32.win32.x86_64.zip` to another folder. 
    It isn't recommended to overwrite the existing folder.

## How to build and run via Eclipse IDE

### Getting the source code into the Eclipse IDE

Requirements:

* Recommended: [Eclipse 2020.12](https://www.eclipse.org/downloads/packages/release/2020-12/r/eclipse-ide-rcp-and-rap-developers) for Mac
  or [Eclipse 2020.06](https://www.eclipse.org/downloads/packages/release/2020-06/r/eclipse-ide-rcp-and-rap-developers) for Linux and Windows. 
* Warning: May not work properly with older versions of Eclipse. 

To import the source code into Eclipse IDE:

* Start Eclipse
* Open the Import window via the menu File > Import
* Select the import wizard General > Existing Projects into Workspace and click Next >
* In Select root directory, select the directory where you have downloaded (the Git root)
* In the Options section of the window, activate Search for nested projects
* Click Finish

to run:

* Open product configuration `hpcviewer.product` at `edu.rice.cs.hpcviewer.product`
* To run: Click `Launch an Eclipse application`
* To export: Click `Eclipse product export wizard`


## Coding style

Recommended coding and formatting style: [https://google.github.io/styleguide/javaguide.html](Google Java style guide).
